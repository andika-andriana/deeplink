<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deep Link Redirect</title>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f4f4f4;
        font-family: Arial, sans-serif;
      }
      .container {
        text-align: center;
      }
      .message {
        font-size: 18px;
        margin-bottom: 20px;
      }
      .link {
        color: #007bff;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="message">Redirecting you to the app...</div>
      <a id="fallbackLink" class="link" href="#"
        >Click here if you are not redirected automatically</a
      >
    </div>

    <script>
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      function redirectToApp() {
        const userAgent =
          navigator.userAgent || navigator.vendor || window.opera;
        const path = getQueryParam("link") || "";
        const iosStoreLink = "https://apps.apple.com/us/app/6479970882";
        const androidStoreLink =
          "https://play.google.com/store/apps/details?id=com.antikode.loyalty";
        const androidAppLink = `intent://${path}#Intent;scheme=https;package=com.antikode.loyalty;end`;
        const iosAppLink = `antiloyalty://${path}`;

        if (/android/i.test(userAgent)) {
          // Redirect Android users
          window.location = androidAppLink;
          document.getElementById("fallbackLink").href = androidStoreLink;
          setTimeout(() => {
            window.location = androidStoreLink;
          }, 3000);
        } else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
          // Redirect iOS users
          window.location = iosAppLink;
          document.getElementById("fallbackLink").href = iosStoreLink;
          setTimeout(() => {
            window.location = iosStoreLink;
          }, 3000);
        } else {
          // Redirect desktop users to a website or show a message
          window.location = "https://demo-nexus.antikode.dev/docs/api/";
        }
      }

      window.onload = redirectToApp;
    </script>
  </body>
</html>
